<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Time-Based Uni-Directional Attestation</title>

  
<style type="text/css">/*<![CDATA[*/
@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}

@media screen and (min-width: 1024px) {
  ul.toc, #rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 500px);
    width: 300px;
    padding: 0 1em;
    z-index: 1;
  }
  #rfc\.toc {
    top: 16px;
  }
  ul.toc {
    top: 80px;
    overflow: auto;
  }

  body {
    padding-left: 1.5em;
    padding-right: 29em;
  }
}

body {
  font: 15px "Helvetica Neue",Helvetica,Arial,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 130%;
  margin: 2.5em auto;
  max-width: 724px;
}

.title, .filename, h1, h2, h3, h4 {
  font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
  font-size-adjust: 0.5;
  font-weight: 500;
  color: #333;
  line-height: 100%;
  margin: 0.8em 0 0.3em;
}
.title { font-size: 36px; }
h1 { font-size: 30px; }
h2 { font-size: 24px; }
h3, h4 { font-size: 18px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

ul.toc li {
  list-style: none;
  text-indent: -2.5em;
  padding-left: 2.5em;
  padding-bottom: 5px;
  margin: 0;
}
ul.toc ul {
  margin: 0;
}
/* xml2rfc nests ul directly inside ul which messes with the style badly */
ul.toc, ul.toc>ul, ul.toc ul>ul {
  margin: 0 0 0 1.5em;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header {
  width: 100%;
}
table.header td {
  border: none;
  background-color: transparent;
  color: black;
}
.filename {
  color: rgb(119, 119, 119);
  font-size: 23px;
  font-weight: normal;
  height: auto;
  line-height: 100%;
}
#rfc\.abstract+p {
  font-size: 20px;
  font-weight: 300;
  line-height: 130%;
}

samp, tt, code, pre {
  font: 11pt consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure {
  font-style: italic;
  margin: 0 1.5em;
}

address {
  margin: 10px 0 0;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn {
  font-weight: bold;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

ol, ul, li, p {
  padding: 0;
  margin: 0.5em 0 0.5em 2em;
}
li, p {
  margin-left: 0;
}
address {
  font-style: normal;
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
  /*]]>*/</style>


  <link href="#rfc.toc" rel="Contents"/>
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction"/>
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Remote Attestation"/>
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Attestation and Verification"/>
<link href="#rfc.section.1.3" rel="Chapter" title="1.3 Information Elements and Conveyance"/>
<link href="#rfc.section.1.4" rel="Chapter" title="1.4 TUDA Objectives"/>
<link href="#rfc.section.1.5" rel="Chapter" title="1.5 Hardware Dependencies"/>
<link href="#rfc.section.1.6" rel="Chapter" title="1.6 Requirements Notation"/>
<link href="#rfc.section.2" rel="Chapter" title="2 TUDA Core Concept"/>
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Terminology"/>
<link href="#rfc.section.2.1.1" rel="Chapter" title="2.1.1 Roles"/>
<link href="#rfc.section.2.1.2" rel="Chapter" title="2.1.2 General Types"/>
<link href="#rfc.section.2.1.3" rel="Chapter" title="2.1.3 TPM-Specific Terms"/>
<link href="#rfc.section.2.1.4" rel="Chapter" title="2.1.4 Certificates"/>
<link href="#rfc.section.3" rel="Chapter" title="3 Time-Based Uni-Directional Attestation"/>
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 TUDA Information Elements Update Cycles"/>
<link href="#rfc.section.4" rel="Chapter" title="4 IANA Considerations"/>
<link href="#rfc.section.5" rel="Chapter" title="5 Security Considerations"/>
<link href="#rfc.section.6" rel="Chapter" title="6 Change Log"/>
<link href="#rfc.section.7" rel="Chapter" title="7 Contributors"/>
<link href="#rfc.references" rel="Chapter" title="8 References"/>
<link href="#rfc.references.1" rel="Chapter" title="8.1 Normative References"/>
<link href="#rfc.references.2" rel="Chapter" title="8.2 Informative References"/>
<link href="#rfc.appendix.A" rel="Chapter" title="A REST Realization"/>
<link href="#rfc.appendix.B" rel="Chapter" title="B SNMP Realization"/>
<link href="#rfc.appendix.B.1" rel="Chapter" title="B.1 Structure of TUDA MIB"/>
<link href="#rfc.appendix.B.1.1" rel="Chapter" title="B.1.1 Cycle Index"/>
<link href="#rfc.appendix.B.1.2" rel="Chapter" title="B.1.2 Instance Index"/>
<link href="#rfc.appendix.B.1.3" rel="Chapter" title="B.1.3 Fragment Index"/>
<link href="#rfc.appendix.B.2" rel="Chapter" title="B.2 Relationship to Host Resources MIB"/>
<link href="#rfc.appendix.B.3" rel="Chapter" title="B.3 Relationship to Entity MIB"/>
<link href="#rfc.appendix.B.4" rel="Chapter" title="B.4 Relationship to Other MIBs"/>
<link href="#rfc.appendix.B.5" rel="Chapter" title="B.5 Definition of TUDA MIB"/>
<link href="#rfc.appendix.C" rel="Chapter" title="C YANG Realization"/>
<link href="#rfc.appendix.D" rel="Chapter" title="D Realization with TPM 1.2 functions"/>
<link href="#rfc.appendix.D.1" rel="Chapter" title="D.1 TPM Functions"/>
<link href="#rfc.appendix.D.1.1" rel="Chapter" title="D.1.1 Tick-Session and Tick-Stamp"/>
<link href="#rfc.appendix.D.1.2" rel="Chapter" title="D.1.2 Platform Configuration Registers (PCRs)"/>
<link href="#rfc.appendix.D.1.3" rel="Chapter" title="D.1.3 PCR restricted Keys"/>
<link href="#rfc.appendix.D.1.4" rel="Chapter" title="D.1.4 CertifyInfo"/>
<link href="#rfc.appendix.D.2" rel="Chapter" title="D.2 Protocol and Procedure"/>
<link href="#rfc.appendix.D.2.1" rel="Chapter" title="D.2.1 AIK and AIK Certificate"/>
<link href="#rfc.appendix.D.2.2" rel="Chapter" title="D.2.2 Synchronization Token"/>
<link href="#rfc.appendix.D.2.3" rel="Chapter" title="D.2.3 RestrictionInfo"/>
<link href="#rfc.appendix.D.2.4" rel="Chapter" title="D.2.4 Measurement Log"/>
<link href="#rfc.appendix.D.2.5" rel="Chapter" title="D.2.5 Implicit Attestation"/>
<link href="#rfc.appendix.D.2.6" rel="Chapter" title="D.2.6 Attestation Verification Approach"/>
<link href="#rfc.acknowledgements" rel="Chapter"/>
<link href="#rfc.authors" rel="Chapter"/>


  <meta name="generator" content="xml2rfc version 2.5.2 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Fuchs, A., Birkholz, H., McDonald, I., and C. Bormann" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-birkholz-tuda-latest" />
  <meta name="dct.issued" scheme="ISO8601" content="2017-1-11" />
  <meta name="dct.abstract" content="This memo documents the method and bindings used to conduct time-based uni-directional attestation between distinguishable endpoints over the network." />
  <meta name="description" content="This memo documents the method and bindings used to conduct time-based uni-directional attestation between distinguishable endpoints over the network." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
  <td class="left">Network Working Group</td>
  <td class="right">A. Fuchs</td>
</tr>
<tr>
  <td class="left">Internet-Draft</td>
  <td class="right">H. Birkholz</td>
</tr>
<tr>
  <td class="left">Intended status: Informational</td>
  <td class="right">Fraunhofer SIT</td>
</tr>
<tr>
  <td class="left">Expires: July 15, 2017</td>
  <td class="right">I. McDonald</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">High North Inc</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">C. Bormann</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">Universitaet Bremen TZI</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">January 11, 2017</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Time-Based Uni-Directional Attestation<br />
  <span class="filename">draft-birkholz-tuda-latest</span></p>
  
  <h1 id="rfc.abstract">
  <a href="#rfc.abstract">Abstract</a>
</h1>
<p>This memo documents the method and bindings used to conduct time-based uni-directional attestation between distinguishable endpoints over the network.</p>
<h1 id="rfc.status">
  <a href="#rfc.status">Status of This Memo</a>
</h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on July 15, 2017.</p>
<h1 id="rfc.copyrightnotice">
  <a href="#rfc.copyrightnotice">Copyright Notice</a>
</h1>
<p>Copyright (c) 2017 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a></li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Remote Attestation</a></li>
<li>1.2.   <a href="#rfc.section.1.2">Attestation and Verification</a></li>
<li>1.3.   <a href="#rfc.section.1.3">Information Elements and Conveyance</a></li>
<li>1.4.   <a href="#rfc.section.1.4">TUDA Objectives</a></li>
<li>1.5.   <a href="#rfc.section.1.5">Hardware Dependencies</a></li>
<li>1.6.   <a href="#rfc.section.1.6">Requirements Notation</a></li>
</ul><li>2.   <a href="#rfc.section.2">TUDA Core Concept</a></li>
<ul><li>2.1.   <a href="#rfc.section.2.1">Terminology</a></li>
<ul><li>2.1.1.   <a href="#rfc.section.2.1.1">Roles</a></li>
<li>2.1.2.   <a href="#rfc.section.2.1.2">General Types</a></li>
<li>2.1.3.   <a href="#rfc.section.2.1.3">TPM-Specific Terms</a></li>
<li>2.1.4.   <a href="#rfc.section.2.1.4">Certificates</a></li>
</ul></ul><li>3.   <a href="#rfc.section.3">Time-Based Uni-Directional Attestation</a></li>
<ul><li>3.1.   <a href="#rfc.section.3.1">TUDA Information Elements Update Cycles</a></li>
</ul><li>4.   <a href="#rfc.section.4">IANA Considerations</a></li>
<li>5.   <a href="#rfc.section.5">Security Considerations</a></li>
<li>6.   <a href="#rfc.section.6">Change Log</a></li>
<li>7.   <a href="#rfc.section.7">Contributors</a></li>
<li>8.   <a href="#rfc.references">References</a></li>
<ul><li>8.1.   <a href="#rfc.references.1">Normative References</a></li>
<li>8.2.   <a href="#rfc.references.2">Informative References</a></li>
</ul><li>Appendix A.   <a href="#rfc.appendix.A">REST Realization</a></li>
<li>Appendix B.   <a href="#rfc.appendix.B">SNMP Realization</a></li>
<ul><li>B.1.   <a href="#rfc.appendix.B.1">Structure of TUDA MIB</a></li>
<ul><li>B.1.1.   <a href="#rfc.appendix.B.1.1">Cycle Index</a></li>
<li>B.1.2.   <a href="#rfc.appendix.B.1.2">Instance Index</a></li>
<li>B.1.3.   <a href="#rfc.appendix.B.1.3">Fragment Index</a></li>
</ul><li>B.2.   <a href="#rfc.appendix.B.2">Relationship to Host Resources MIB</a></li>
<li>B.3.   <a href="#rfc.appendix.B.3">Relationship to Entity MIB</a></li>
<li>B.4.   <a href="#rfc.appendix.B.4">Relationship to Other MIBs</a></li>
<li>B.5.   <a href="#rfc.appendix.B.5">Definition of TUDA MIB</a></li>
</ul><li>Appendix C.   <a href="#rfc.appendix.C">YANG Realization</a></li>
<li>Appendix D.   <a href="#rfc.appendix.D">Realization with TPM 1.2 functions</a></li>
<ul><li>D.1.   <a href="#rfc.appendix.D.1">TPM Functions</a></li>
<ul><li>D.1.1.   <a href="#rfc.appendix.D.1.1">Tick-Session and Tick-Stamp</a></li>
<li>D.1.2.   <a href="#rfc.appendix.D.1.2">Platform Configuration Registers (PCRs)</a></li>
<li>D.1.3.   <a href="#rfc.appendix.D.1.3">PCR restricted Keys</a></li>
<li>D.1.4.   <a href="#rfc.appendix.D.1.4">CertifyInfo</a></li>
</ul><li>D.2.   <a href="#rfc.appendix.D.2">Protocol and Procedure</a></li>
<ul><li>D.2.1.   <a href="#rfc.appendix.D.2.1">AIK and AIK Certificate</a></li>
<li>D.2.2.   <a href="#rfc.appendix.D.2.2">Synchronization Token</a></li>
<li>D.2.3.   <a href="#rfc.appendix.D.2.3">RestrictionInfo</a></li>
<li>D.2.4.   <a href="#rfc.appendix.D.2.4">Measurement Log</a></li>
<li>D.2.5.   <a href="#rfc.appendix.D.2.5">Implicit Attestation</a></li>
<li>D.2.6.   <a href="#rfc.appendix.D.2.6">Attestation Verification Approach</a></li>
</ul></ul><li><a href="#rfc.acknowledgements">Acknowledgements</a></li>
<li><a href="#rfc.authors">Authors' Addresses</a></li>


  </ul>

  <h1 id="rfc.section.1"><a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a></h1>
<p id="rfc.section.1.p.1">Remote attestation describes the attempt to determine and appraise the properties, such as integrity and trustworthiness, of an endpoint &#8212; the attestee &#8212; over a network to another endpoint &#8212; the verifier &#8212; without direct access. Typically, this kind of assessment is based on measurements of software components running on the attestee, where the hash values of all started software components are stored (extended into) a Trust-Anchor implemented as a Hardware Security Module (e.g. a Trusted Platform Module or similar) and reported via a signature over the measurements.</p>
<h1 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1.</a> <a href="#remote-attestation" id="remote-attestation">Remote Attestation</a></h1>
<p id="rfc.section.1.1.p.1">In essence, remote attestation is composed of three activities. The following definitions are derived from the definitions presented in <a href="#PRIRA">[PRIRA]</a> and <a href="#TCGGLOSS">[TCGGLOSS]</a>.</p>
<p/>

<dl>
  <dt>Attestation:</dt>
  <dd style="margin-left: 8">The creation of a claim about the properties of an attestee, such that the claim can be used as evidence.</dd>
  <dt>Conveyance:</dt>
  <dd style="margin-left: 8">The transfer of evidence from the attestee to the verifier.</dd>
  <dt>Verification:</dt>
  <dd style="margin-left: 8">The appraisal of evidence by evaluating it against declarative guidance.</dd>
</dl>
<p id="rfc.section.1.1.p.3">Protocols that facilitate Trust-Anchor based signatures in order to provide remote attestation are usually bi-directional challenge/response protocols, such as the Platform Trust Service protocol <a href="#PTS">[PTS]</a> or CAVES <a href="#PRIRA">[PRIRA]</a>, where one entity sends a challenge that is included inside the response to ensure the recentness &#8212; the freshness &#8212; of the attestation information. The corresponding interaction model tightly couples the three activities of creating, transferring and appraising evidence.</p>
<p id="rfc.section.1.1.p.4">The Time-Based Uni-directional Attestation protocol &#8212; TUDA &#8212; described in this document can decouple the three activities remote attestation is composed of. As a result, TUDA provides additional capabilities, such as:</p>
<p/>

<ul>
  <li>remote attestation for attestees that might not always be able to reach the Internet by enabling the authentication of past states,</li>
  <li>secure audit logs by combining the evidence created via TUDA with measurement logs that represent a detailed record of corresponding past states,</li>
  <li>an uni-directional interaction model that can traverse "diode-like" network security functions or can be leveraged in RESTfull architectures (e.g. CoAP <a href="#RFC7252">[RFC7252]</a>), analogously.</li>
</ul>
<h1 id="rfc.section.1.2"><a href="#rfc.section.1.2">1.2.</a> <a href="#attestation-and-verification" id="attestation-and-verification">Attestation and Verification</a></h1>
<p id="rfc.section.1.2.p.1">The attestation activity of TUDA requires a Trusted Platform Module (TPM <a href="#TPM12">[TPM12]</a>), a specific Hardware Security Module (HSM) providing, e.g., Platform Configuration Registers (PCR), restricted signing keys, and a source of (relative) time (i.e. a tick-counter).</p>
<p id="rfc.section.1.2.p.2">Both the attestation and the verification activity of TUDA require a trusted Time Stamp Authority (TSA) <a href="#RFC3161">[RFC3161]</a> as an additional third party next to the attestee and the verifier. The combination of the local source of time provided by the TPM (located on the attestee) and the Time Stamp Tokens provided by the TSA (to both the attestee and the verifier) enable the attestation and verification of an appropriate freshness of the evidence conveyed by the attestee &#8212; without requiring a challenge/response interaction model that uses a nonce to ensure the freshness.</p>
<p id="rfc.section.1.2.p.3">The verification activity also requires declarative guidance (representing desired or compliant endpoint configuration and state) evidence conveyed by the attestee can be evaluated against. The acquisition or representation of declarative guidance as well as the corresponding evaluation methods are out of the scope of this document.</p>
<h1 id="rfc.section.1.3"><a href="#rfc.section.1.3">1.3.</a> <a href="#information-elements-and-conveyance" id="information-elements-and-conveyance">Information Elements and Conveyance</a></h1>
<p id="rfc.section.1.3.p.1">TUDA defines a set of information elements (IE) that are created or stored on the attestee and are intended to be transferred to the verifier in order to enable appraisal.</p>
<p id="rfc.section.1.3.p.2">Each TUDA IE is encoded in the Concise Binary Object Representation (CBOR <a href="#RFC7049">[RFC7049]</a>) to minimize the volume of data in motion. In this document, the composition of the CBOR data items that represent IE is described using the CBOR Data Definition Language, CDDL <a href="#I-D.greevenbosch-appsawg-cbor-cddl">[I-D.greevenbosch-appsawg-cbor-cddl]</a>.</p>
<p id="rfc.section.1.3.p.3">Each TUDA IE that requires a certain freshness is only created/updated when out-dated, which reduces the overall resources required from the attestee, including the utilization of the TPM. The IE that have to be created are determined by their age or by specific state changes on the attestee (e.g. state changes due to a reboot-cycle).</p>
<p id="rfc.section.1.3.p.4">Each TUDA IE is only transferred when required, which reduces the amount of data in motion necessary to conduct remote attestation significantly. Only IE that have changed since their last conveyance have to be transferred.</p>
<p id="rfc.section.1.3.p.5">Each TUDA IE that requires a certain freshness can be reused for multiple remote attestation procedures in the limits of its corresponding freshness-window, further reducing the load imposed on the attestee and its corresponding TPM.</p>
<h1 id="rfc.section.1.4"><a href="#rfc.section.1.4">1.4.</a> <a href="#tuda-objectives" id="tuda-objectives">TUDA Objectives</a></h1>
<p id="rfc.section.1.4.p.1">The Time-Based Uni-directional Attestation is designed to:</p>
<p/>

<ul>
  <li>increase the confidence in authentication and authorization procedures,</li>
  <li>address the requirements of constrained-node networks,</li>
  <li>support interaction models that do not maintain connection-state over time, such as REST architectures <a href="#REST">[REST]</a>,</li>
  <li>be able to leverage existing management interfaces, such as SNMP <a href="#RFC3411">[RFC3411]</a>. RESTCONF <a href="#I-D.ietf-netconf-restconf">[I-D.ietf-netconf-restconf]</a> or CoMI <a href="#I-D.vanderstok-core-comi">[I-D.vanderstok-core-comi]</a> &#8212; and corresponding bindings,</li>
  <li>support broadcast and multicast schemes (e.g. <a href="#IEEE1609">[IEEE1609]</a>),</li>
  <li>be able to cope with temporary loss of connectivity, and to</li>
  <li>provide trustworthy audit logs of past endpoint states.</li>
</ul>
<h1 id="rfc.section.1.5"><a href="#rfc.section.1.5">1.5.</a> <a href="#hardware-dependencies" id="hardware-dependencies">Hardware Dependencies</a></h1>
<p id="rfc.section.1.5.p.1">The binding of the attestation scheme used by TUDA to generate the TUDA IE is specific to the methods provided by the HSM used. As a reference, this document includes pseudo-code that illustrates the production of TUDA IE using a TPM 1.2 and the corresponding TPM commands specified in <a href="#TPM12">[TPM12]</a> as an example. The references to TPM 1.2 commands and corresponding pseudo-code only serve as guidance to enable a better understanding of the attestation scheme and is intended to encourages the use of any appropriate HSM or equivalent set of Trust-Zone functions.</p>
<h1 id="rfc.section.1.6"><a href="#rfc.section.1.6">1.6.</a> <a href="#requirements-notation" id="requirements-notation">Requirements Notation</a></h1>
<p id="rfc.section.1.6.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in RFC 2119, BCP 14 <a href="#RFC2119">[RFC2119]</a>.</p>
<h1 id="rfc.section.2"><a href="#rfc.section.2">2.</a> <a href="#tuda-core-concept" id="tuda-core-concept">TUDA Core Concept</a></h1>
<p id="rfc.section.2.p.1">There are significant differences between conventional bi-directional attestation and TUDA regarding both the information elements conveyed between attestee and verifier and the time-frame, in which an attestation can be considered to be fresh (and therefore trustworthy).</p>
<p id="rfc.section.2.p.2">In general, remote attestation using a bi-directional communication scheme includes sending a nonce-challenge within a signed attestation token. Using the TPM 1.2 as an example, a corresponding nonce-challenge would be included within the signature created by the TPM_Quote command in order to prove the freshness of the attestation response, see e.g. <a href="#PTS">[PTS]</a>.</p>
<p id="rfc.section.2.p.3">In contrast, the TUDA protocol would use a combination output of TPM_CertifyInfo and TPM_TickStampBlob. The former provides a proof about the platform's state by attesting that a certain key is bound to said state. The latter provides proof that the platform was in the specified state by using the bound key in a time operation. This combination enables a time-based attestation scheme. This approach is based on the concepts introduced in <a href="#SCALE">[SCALE]</a> and <a href="#SFKE2008">[SFKE2008]</a>.</p>
<p id="rfc.section.2.p.4">The payload of information elements transmitted is based on different methods, because the time-frame, in which an attestation is considered to be fresh (and therefore trustworthy), is defined differently.</p>
<p id="rfc.section.2.p.5">The freshness properties of a challenge-response based protocol define the point-of-time of attestation between:</p>
<p/>

<ul>
  <li>the time of transmission of the nonce, and</li>
  <li>the reception of the response</li>
</ul>
<p id="rfc.section.2.p.7">Given the time-based attestation scheme, the freshness property of TUDA is equivalent to that of bi-directional challenge response attestation, if the point-in-time of attestation lies between:</p>
<p/>

<ul>
  <li>the transmission of a TUDA time-synchronization token, and</li>
  <li>the typical round-trip time between the verifier and the attestee,</li>
</ul>
<p id="rfc.section.2.p.9">The accuracy of this time-frame is defined by two factors:</p>
<p/>

<ul>
  <li>the time-synchronization between the attestee and the TSA. The time between the two TPM tickstamps give the maximum drift (left and right) to the TSA timestamp, and</li>
  <li>the drift of local TPM clocks.</li>
</ul>
<p id="rfc.section.2.p.11">Since TUDA attestations do not rely upon a verifier provided value (i.e. the nonce), the security guarantees of the protocol only incorporate the TSA and the TPM. As a consequence TUDA attestations can even serve as proof of integrity in audit logs with point in time guarantees, in contrast to classical attestations.</p>
<p><a href="#rest">Appendix A</a> contains guidance on how to utilize a REST architecture.</p>
<p><a href="#snmp">Appendix B</a> contains guidance on how to create an SNMP binding and a corresponding TUDA-MIB.</p>
<p><a href="#yang">Appendix C</a> contains a corrresponding YANG module that supports both RESTCONF and CoMI.</p>
<p><a href="#tpm12">Appendix D</a> contains a realization of TUDA using TPM 1.2 primitives.  A realization of TUDA using TPM 2.0 primitives will be added with the next iteration of this document.</p>
<h1 id="rfc.section.2.1"><a href="#rfc.section.2.1">2.1.</a> <a href="#terminology" id="terminology">Terminology</a></h1>
<p id="rfc.section.2.1.p.1">This document introduces roles, information elements and types required to conduct TUDA and uses terminology (e.g. specific certificate names) typically seen in the context of attestation or hardware security modules.</p>
<h1 id="rfc.section.2.1.1"><a href="#rfc.section.2.1.1">2.1.1.</a> <a href="#roles" id="roles">Roles</a></h1>
<p/>

<dl>
  <dt>Attestee:</dt>
  <dd style="margin-left: 8">the endpoint that is the subject of the attestation to another endpoint.</dd>
  <dt>Verifier:</dt>
  <dd style="margin-left: 8">the endpoint that consumes the attestation of another endpoint.</dd>
  <dt>TSA:</dt>
  <dd style="margin-left: 8">a Time Stamp Authority <a href="#RFC3161">[RFC3161]</a></dd>
</dl>
<h1 id="rfc.section.2.1.2"><a href="#rfc.section.2.1.2">2.1.2.</a> <a href="#general-types" id="general-types">General Types</a></h1>
<p/>

<dl>
  <dt>Byte:</dt>
  <dd style="margin-left: 8">the now customary synonym for octet</dd>
  <dt>Cert:</dt>
  <dd style="margin-left: 8">an X.509 certificate represented as a byte-string</dd>
  <dt>PCR-Hash:</dt>
  <dd style="margin-left: 8">a hash value of the security posture measurements stored in a TPM Platform Configuration Register (e.g. regarding running software instances) represented as a byte-string</dd>
</dl>
<h1 id="rfc.section.2.1.3"><a href="#rfc.section.2.1.3">2.1.3.</a> <a href="#tpm-specific-terms" id="tpm-specific-terms">TPM-Specific Terms</a></h1>
<p/>

<dl>
  <dt>AIK:</dt>
  <dd style="margin-left: 8">an Attestation Identity Key, a special key type used within a TPM for identity-related operations (such as TPM_Certify or TPM_Quote)</dd>
  <dt>PCR:</dt>
  <dd style="margin-left: 8">a Platform Configuration Register that is part of a TPM and is used to securely store and report measurements about security posture</dd>
</dl>
<h1 id="rfc.section.2.1.4"><a href="#rfc.section.2.1.4">2.1.4.</a> <a href="#certificates" id="certificates">Certificates</a></h1>
<p/>

<dl>
  <dt>TSA-CA:</dt>
  <dd style="margin-left: 8">the Certificate Authority that provides the certificate for the TSA represented as a Cert</dd>
  <dt>AIK-CA:</dt>
  <dd style="margin-left: 8">the Certificate Authority that provides the certificate for the attestation identity key of the TPM. This is the client platform credential for this protocol. It is a placeholder for a specific CA and AIK-Cert is a placeholder for the corresponding certificate, depending on what protocol was used. The specific protocols are out of scope for this document, see also <a href="#AIK-Enrollment">[AIK-Enrollment]</a> and <a href="#IEEE802.1AR">[IEEE802.1AR]</a>.</dd>
</dl>
<h1 id="rfc.section.3"><a href="#rfc.section.3">3.</a> <a href="#time-based-uni-directional-attestation" id="time-based-uni-directional-attestation">Time-Based Uni-Directional Attestation</a></h1>
<p id="rfc.section.3.p.1">A Time-Based Uni-Directional Attestation (TUDA) consists of the following seven information elements. They are used to gain assurance of the Attestee's platform configuration at a certain point in time:</p>
<p/>

<dl>
  <dt>TSA Certificate:</dt>
  <dd style="margin-left: 8">The certificate of the Time Stamp Authority that is used in a subsequent synchronization protocol token. This certificate is signed by the TSA-CA.</dd>
  <dt>AIK Certificate (&lt;xref target="AIK-Credential"/&gt;, &lt;xref target="AIK-Enrollment"/&gt;; see &lt;xref target="aik"/&gt;):</dt>
  <dd style="margin-left: 8">A certificate about the Attestation Identity Key (AIK) used. This may or may not also be an <a href="#IEEE802.1AR">[IEEE802.1AR]</a> IDevID or LDevID, depending on their setting of the corresponding identity property.</dd>
  <dt>Synchronization Token:</dt>
  <dd style="margin-left: 8">The reference for Attestations are the Tick-Sessions of the TPM. In order to put Attestations into relation with a Real Time Clock (RTC), it is necessary to provide a cryptographic synchronization between the tick session and the RTC. To do so, a synchronization protocol is run with a Time Stamp Authority (TSA).</dd>
  <dt>Restriction Info:</dt>
  <dd style="margin-left: 8">The attestation relies on the capability of the TPM to operate on restricted keys.  Whenever the PCR values for the machine to be attested change, a new restricted key is created that can only be operated as long as the PCRs remain in their current state.</dd>
  <dt></dt>
  <dd style="margin-left: 8">In order to prove to the Verifier that this restricted temporary key actually has these properties and also to provide the PCR value that it is restricted, the TPM command TPM_CertifyInfo is used. It creates a signed certificate using the AIK about the newly created restricted key.</dd>
  <dt>Measurement Log:</dt>
  <dd style="margin-left: 8">Similarly to regular attestations, the Verifier needs a way to reconstruct the PCRs' values in order to estimate the trustworthiness of the device. As such, a list of those elements that were extended into the PCRs is reported. Note though that for certain environments, this step may be optional if a list of valid PCR configurations exists and no measurement log is required.</dd>
  <dt>Implicit Attestation:</dt>
  <dd style="margin-left: 8">The actual attestation is then based upon a TPM_TickStampBlob operation using the restricted temporary key that was certified in the steps above. The TPM_TickStampBlob is executed and thereby provides evidence that at this point in time (with respect to the TPM internal tick-session) a certain configuration existed (namely the PCR values associated with the restricted key). Together with the synchronization token this tick-related timing can then be related to the real-time clock.</dd>
  <dt>Concise SWID tags:</dt>
  <dd style="margin-left: 8">As an option to better assess the trustworthiness of an Attestee, a Verifier can request the reference hashes (often referred to as golden measurements) of all started software components to compare them with the entries in the measurement log. References hashes regarding installed (and therefore running) software can be provided by the manufacturer via SWID tags. SWID tags are provided by the Attestee using the Concise SWID representation <a href="#I-D-birkholz-sacm-coswid">[I-D-birkholz-sacm-coswid]</a> and bundled into a CBOR array.  Ideally, the reference hashes include a signature created by the manufacturer of the software.</dd>
</dl>
<p id="rfc.section.3.p.3">These information elements could be sent en bloc, but it is recommended to retrieve them separately to save bandwidth, since these elements have different update cycles. In most cases, retransmitting all seven information elements would result in unnecessary redundancy.</p>
<p id="rfc.section.3.p.4">Furthermore, in some scenarios it might be feasible not to store all elements on the Attestee endpoint, but instead they could be retrieved from another location or pre-deployed to the Verifier.  It is also feasible to only store public keys at the Verifier and skip the whole certificate provisioning completely in order to save bandwidth and computation time for certificate verification.</p>
<h1 id="rfc.section.3.1"><a href="#rfc.section.3.1">3.1.</a> <a href="#updatecycles" id="updatecycles">TUDA Information Elements Update Cycles</a></h1>
<p id="rfc.section.3.1.p.1">An endpoint can be in various states and have various information associated with it during its life cycle. For TUDA, a subset of the states (which can include associated information) that an endpoint and its TPM can be in, is important to the attestation process.</p>
<p/>

<ul>
  <li>Some states are persistent, even after reboot. This includes certificates that are associated with the endpoint itself or with services it relies on.</li>
  <li>Some states are more volatile and change at the beginning of each boot cycle.  This includes the TPM-internal Tick-Session which provides the basis for the synchronization token and implicit attestation.</li>
  <li>Some states are even more volatile and change during an uptime cycle (the period of time an endpoint is powered on, starting with its boot).  This includes the content of PCRs of a TPM and thereby also the PCR-restricted keys used during attestation.</li>
</ul>
<p id="rfc.section.3.1.p.3">Depending on this "lifetime of state", data has to be transported over the wire, or not. E.g. information that does not change due to a reboot typically has to be transported only once between the Attestee and the Verifier.</p>
<p id="rfc.section.3.1.p.4">There are three kinds of events that require a renewed attestation:</p>
<p/>

<ul>
  <li>The Attestee completes a boot-cycle</li>
  <li>A relevant PCR changes</li>
  <li>Too much time has passed since the last attestation statement</li>
</ul>
<p id="rfc.section.3.1.p.6">The third event listed above is variable per application use case and can therefore be set appropriately. For usage scenarios, in which the device would periodically push information to be used in an audit-log, a time-frame of approximately one update per minute should be sufficient in most cases. For those usage scenarios, where verifiers request (pull) a fresh attestation statement, an implementation could use the TPM continuously to always present the most freshly created results. To save some utilization of the TPM for other purposes, however, a time-frame of once per ten seconds is recommended, which would leave 80% of utilization for applications.</p>
<div id="rfc.figure.1"/>
<div id="SequenceExample"/>
<pre>
Attestee                                                 Verifier
   |                                                         |
 Boot                                                        |
   |                                                         |
 Create Sync-Token                                           |
   |                                                         |
 Create Restricted Key                                       |
 Certify Restricted Key                                      |
   |                                                         |
   | AIK-Cert ---------------------------------------------&gt; |
   | Sync-Token -------------------------------------------&gt; |
   | Certify-Info -----------------------------------------&gt; |
   | Measurement Log --------------------------------------&gt; |
   | Attestation ------------------------------------------&gt; |
   |                                           Verify Attestation
   |                                                         |
   |       &lt;Time Passed&gt;                                     |
   |                                                         |
   | Attestation ------------------------------------------&gt; |
   |                                           Verify Attestation
   |                                                         |
   |       &lt;Time Passed&gt;                                     |
   |                                                         |
 PCR-Change                                                  |
   |                                                         |
 Create Restricted Key                                       |
 Certify Restricted Key                                      |
   |                                                         |
   | Certify-Info -----------------------------------------&gt; |
   | Measurement Log --------------------------------------&gt; |
   | Attestation ------------------------------------------&gt; |
   |                                           Verify Attestation
   |                                                         |
 Boot                                                        |
   |                                                         |
 Create Sync-Token                                           |
   |                                                         |
 Create Restricted Key                                       |
 Certify Restricted Key                                      |
   |                                                         |
   | Sync-Token -------------------------------------------&gt; |
   | Certify-Info -----------------------------------------&gt; |
   | Measurement Log --------------------------------------&gt; |
   | Attestation ------------------------------------------&gt; |
   |                                           Verify Attestation
   |                                                         |
   |       &lt;Time Passed&gt;                                     |
   |                                                         |
   | Attestation ------------------------------------------&gt; |
   |                                           Verify Attestation
   |                                                         |
</pre>
<p class="figure">Figure 1: Example sequence of events</p>
<h1 id="rfc.section.4"><a href="#rfc.section.4">4.</a> <a href="#iana" id="iana">IANA Considerations</a></h1>
<p id="rfc.section.4.p.1">This memo includes requests to IANA, including registrations for media type definitions.</p>
<p id="rfc.section.4.p.2">TBD</p>
<h1 id="rfc.section.5"><a href="#rfc.section.5">5.</a> <a href="#security-considerations" id="security-considerations">Security Considerations</a></h1>
<p id="rfc.section.5.p.1">There are Security Considerations. TBD</p>
<h1 id="rfc.section.6"><a href="#rfc.section.6">6.</a> <a href="#change-log" id="change-log">Change Log</a></h1>
<p id="rfc.section.6.p.1">Changes from version 01 to version 02:</p>
<p/>

<ul>
  <li>Restructuring of Introduction, highlighting conceptual prerequisites</li>
  <li>Restructuring of Concept to better illustrate differences to hand-shake based attestation and deciding factors regarding freshness properties</li>
  <li>Subsection structure added to Terminology</li>
  <li>Clarification of descriptions of approach (these were the FIXMEs)</li>
  <li>Correction of RestrictionInfo structure: Added missing signature member</li>
</ul>
<p id="rfc.section.6.p.3">Changes from version 00 to version 01:</p>
<p id="rfc.section.6.p.4">Major update to the SNMP MIB and added a table for the Concise SWID profile Reference Hashes that provides additional information to be compared with the measurement logs.</p>
<h1 id="rfc.section.7"><a href="#rfc.section.7">7.</a> <a href="#contributors" id="contributors">Contributors</a></h1>
<p id="rfc.section.7.p.1">TBD</p>
<h1 id="rfc.references"><a href="#rfc.references">8.</a> References</h1>
<h1 id="rfc.references.1"><a href="#rfc.references.1">8.1.</a> Normative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="RFC2119">[RFC2119]</b>
      </td>
      <td class="top"><a>Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.references.2"><a href="#rfc.references.2">8.2.</a> Informative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="AIK-Credential">[AIK-Credential]</b>
      </td>
      <td class="top"><a>TCG Infrastructure Working Group</a>, "<a href="https://www.trustedcomputinggroup.org/wp-content/uploads/IWG-Credential_Profiles_V1_R1_14.pdf">TCG Credential Profile</a>", 2007.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="AIK-Enrollment">[AIK-Enrollment]</b>
      </td>
      <td class="top"><a>TCG Infrastructure Working Group</a>, "<a href="https://www.trustedcomputinggroup.org/wp-content/uploads/IWG_CMC_Profile_Cert_Enrollment_v1_r7.pdf">A CMC Profile for AIK Certificate Enrollment</a>", 2011.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="I-D-birkholz-sacm-coswid">[I-D-birkholz-sacm-coswid]</b>
      </td>
      <td class="top"><a>Birkholz, H.</a>, <a>Fitzgerald-McKay, J.</a>, <a>Schmidt, C.</a> and <a>D. Waltermire</a>, "<a href="http://tools.ietf.org/html/draft-birkholz-sacm-coswid-01">Concise Software Identifiers</a>", Internet-Draft draft-birkholz-sacm-coswid-01, March 2016.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="I-D.greevenbosch-appsawg-cbor-cddl">[I-D.greevenbosch-appsawg-cbor-cddl]</b>
      </td>
      <td class="top"><a>Vigano, C.</a> and <a>H. Birkholz</a>, "<a href="http://tools.ietf.org/html/draft-greevenbosch-appsawg-cbor-cddl-09">CBOR data definition language (CDDL): a notational convention to express CBOR data structures</a>", Internet-Draft draft-greevenbosch-appsawg-cbor-cddl-09, September 2016.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="I-D.ietf-netconf-restconf">[I-D.ietf-netconf-restconf]</b>
      </td>
      <td class="top"><a>Bierman, A.</a>, <a>Bjorklund, M.</a> and <a>K. Watsen</a>, "<a href="http://tools.ietf.org/html/draft-ietf-netconf-restconf-18">RESTCONF Protocol</a>", Internet-Draft draft-ietf-netconf-restconf-18, October 2016.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="I-D.vanderstok-core-comi">[I-D.vanderstok-core-comi]</b>
      </td>
      <td class="top"><a>Stok, P.</a>, <a>Bierman, A.</a>, <a>Veillette, M.</a> and <a>A. Pelov</a>, "<a href="http://tools.ietf.org/html/draft-vanderstok-core-comi-10">CoAP Management Interface</a>", Internet-Draft draft-vanderstok-core-comi-10, October 2016.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="IEEE1609">[IEEE1609]</b>
      </td>
      <td class="top"><a>IEEE Computer Society</a>, "<a>1609.4-2016 - IEEE Standard for Wireless Access in Vehicular Environments (WAVE) -- Multi-Channel Operation</a>", IEEE Std 1609.4, 2016.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="IEEE802.1AR">[IEEE802.1AR]</b>
      </td>
      <td class="top"><a>IEEE Computer Society</a>, "<a>802.1AR-2009 - IEEE Standard for Local and metropolitan area networks - Secure Device Identity</a>", IEEE Std 802.1AR, 2009.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="PRIRA">[PRIRA]</b>
      </td>
      <td class="top"><a>Coker, G.</a>, <a>Guttman, J.</a>, <a>Loscocco, P.</a>, <a>Herzog, A.</a>, <a>Millen, J.</a>, <a>O'Hanlon, B.</a>, <a>Ramsdell, J.</a>, <a>Segall, A.</a>, <a>Sheehy, J.</a> and <a>B. Sniffen</a>, "<a>Principles of Remote Attestation</a>", Springer International Journal of Information Security, page 63-81, n.d..</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="PTS">[PTS]</b>
      </td>
      <td class="top"><a>TCG TNC Working Group</a>, "<a href="https://www.trustedcomputinggroup.org/wp-content/uploads/IFM_PTS_v1_0_r28.pdf">TCG Attestation PTS Protocol Binding to TNC IF-M</a>", 2011.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="REST">[REST]</b>
      </td>
      <td class="top"><a title="University of California, Irvine">Fielding, R.</a>, "<a href="http://www.ics.uci.edu/~fielding/pubs/dissertation/fielding_dissertation.pdf">Architectural Styles and the Design of Network-based Software Architectures</a>", Ph.D. Dissertation, University of California, Irvine, 2000.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC1213">[RFC1213]</b>
      </td>
      <td class="top"><a>McCloghrie, K.</a> and <a>M. Rose</a>, "<a href="http://tools.ietf.org/html/rfc1213">Management Information Base for Network Management of TCP/IP-based internets: MIB-II</a>", STD 17, RFC 1213, DOI 10.17487/RFC1213, March 1991.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2790">[RFC2790]</b>
      </td>
      <td class="top"><a>Waldbusser, S.</a> and <a>P. Grillo</a>, "<a href="http://tools.ietf.org/html/rfc2790">Host Resources MIB</a>", RFC 2790, DOI 10.17487/RFC2790, March 2000.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC3161">[RFC3161]</b>
      </td>
      <td class="top"><a>Adams, C.</a>, <a>Cain, P.</a>, <a>Pinkas, D.</a> and <a>R. Zuccherato</a>, "<a href="http://tools.ietf.org/html/rfc3161">Internet X.509 Public Key Infrastructure Time-Stamp Protocol (TSP)</a>", RFC 3161, DOI 10.17487/RFC3161, August 2001.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC3411">[RFC3411]</b>
      </td>
      <td class="top"><a>Harrington, D.</a>, <a>Presuhn, R.</a> and <a>B. Wijnen</a>, "<a href="http://tools.ietf.org/html/rfc3411">An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks</a>", STD 62, RFC 3411, DOI 10.17487/RFC3411, December 2002.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC3418">[RFC3418]</b>
      </td>
      <td class="top"><a>Presuhn, R.</a>, "<a href="http://tools.ietf.org/html/rfc3418">Management Information Base (MIB) for the Simple Network Management Protocol (SNMP)</a>", STD 62, RFC 3418, DOI 10.17487/RFC3418, December 2002.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6690">[RFC6690]</b>
      </td>
      <td class="top"><a>Shelby, Z.</a>, "<a href="http://tools.ietf.org/html/rfc6690">Constrained RESTful Environments (CoRE) Link Format</a>", RFC 6690, DOI 10.17487/RFC6690, August 2012.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6933">[RFC6933]</b>
      </td>
      <td class="top"><a>Bierman, A.</a>, <a>Romascanu, D.</a>, <a>Quittek, J.</a> and <a>M. Chandramouli</a>, "<a href="http://tools.ietf.org/html/rfc6933">Entity MIB (Version 4)</a>", RFC 6933, DOI 10.17487/RFC6933, May 2013.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7049">[RFC7049]</b>
      </td>
      <td class="top"><a>Bormann, C.</a> and <a>P. Hoffman</a>, <a href="http://tools.ietf.org/html/rfc7049">Concise Binary Object Representation (CBOR)</a>", RFC 7049, DOI 10.17487/RFC7049, October 2013.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7230">[RFC7230]</b>
      </td>
      <td class="top"><a>Fielding, R.</a> and <a>J. Reschke</a>, "<a href="http://tools.ietf.org/html/rfc7230">Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing</a>", RFC 7230, DOI 10.17487/RFC7230, June 2014.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7252">[RFC7252]</b>
      </td>
      <td class="top"><a>Shelby, Z.</a>, <a>Hartke, K.</a> and <a>C. Bormann</a>, "<a href="http://tools.ietf.org/html/rfc7252">The Constrained Application Protocol (CoAP)</a>", RFC 7252, DOI 10.17487/RFC7252, June 2014.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7320">[RFC7320]</b>
      </td>
      <td class="top"><a>Nottingham, M.</a>, "<a href="http://tools.ietf.org/html/rfc7320">URI Design and Ownership</a>", BCP 190, RFC 7320, DOI 10.17487/RFC7320, July 2014.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7540">[RFC7540]</b>
      </td>
      <td class="top"><a>Belshe, M.</a>, <a>Peon, R.</a> and <a>M. Thomson</a>, "<a href="http://tools.ietf.org/html/rfc7540">Hypertext Transfer Protocol Version 2 (HTTP/2)</a>", RFC 7540, DOI 10.17487/RFC7540, May 2015.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="SCALE">[SCALE]</b>
      </td>
      <td class="top"><a>Fuchs, A.</a>, "<a>Improving Scalability for Remote Attestation</a>", Master Thesis (Diplomarbeit), Technische Universitaet Darmstadt, Germany, 2008.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="SFKE2008">[SFKE2008]</b>
      </td>
      <td class="top"><a>Stumpf, F.</a>, <a>Fuchs, A.</a>, <a>Katzenbeisser, S.</a> and <a>C. Eckert</a>, <a>Improving the scalability of platform attestation</a>", ACM Proceedings of the 3rd ACM workshop on Scalable trusted computing, page 1-10, 2008.</td>
    </tr>
    <tr><td class="reference"><b id="STD62">[STD62]</b></td><td class="top"><a>Internet Standard 62</a>", STD 62, RFCs 3411 to 3418, December 2002.</td>, "</tr>
    <tr>
      <td class="reference">
        <b id="TCGGLOSS">[TCGGLOSS]</b>
      </td>
      <td class="top"><a>TCG</a>, "<a href="https://www.trustedcomputinggroup.org/wp-content/uploads/TCG_Glossary_Board-Approved_12.13.2012.pdf">TCG Glossary</a>", 2012.</td>
    </tr>
    <tr><td class="reference"><b id="TPM12">[TPM12]</b></td><td class="top"><a>Information technology -- Trusted Platform Module -- Part 1: Overview</a>", ISO/IEC 11889-1, 2009.</td>, "</tr>
  </tbody>
</table>
<h1 id="rfc.appendix.A"><a href="#rfc.appendix.A">Appendix A.</a> <a href="#rest" id="rest">REST Realization</a></h1>
<p id="rfc.section.A.p.1">Each of the seven data items is defined as a media type (<a href="#iana">Section 4</a>).  Representations of resources for each of these media types can be retrieved from URIs that are defined by the respective servers <a href="#RFC7320">[RFC7320]</a>.  As can be derived from the URI, the actual retrieval is via one of the HTTPs (<a href="#RFC7230">[RFC7230]</a>, <a href="#RFC7540">[RFC7540]</a>) or CoAP <a href="#RFC7252">[RFC7252]</a>.  How a client obtains these URIs is dependent on the application; e.g., CoRE Web links <a href="#RFC6690">[RFC6690]</a> can be used to obtain the relevant URIs from the self-description of a server, or they could be prescribed by a RESTCONF data model <a href="#I-D.ietf-netconf-restconf">[I-D.ietf-netconf-restconf]</a>.</p>
<h1 id="rfc.appendix.B"><a href="#rfc.appendix.B">Appendix B.</a> <a href="#snmp" id="snmp">SNMP Realization</a></h1>
<p id="rfc.section.B.p.1">SNMPv3 <a href="#STD62">[STD62]</a> <a href="#RFC3411">[RFC3411]</a> is widely available on computers and also constrained devices.  To transport the TUDA information elements, an SNMP MIB is defined below which encodes each of the seven TUDA information elements into a table.  Each row in a table contains a single read-only columnar SNMP object of datatype OCTET-STRING.  The values of a set of rows in each table can be concatenated to reconstitute a CBOR-encoded TUDA information element.  The Verifier can retrieve the values for each CBOR fragment by using SNMP GetNext requests to "walk" each table and can decode each of the CBOR-encoded data items based on the corresponding CDDL <a href="#I-D.greevenbosch-appsawg-cbor-cddl">[I-D.greevenbosch-appsawg-cbor-cddl]</a> definition.</p>
<p id="rfc.section.B.p.2">Design Principles:</p>
<p/>

<ol>
  <li>Over time, TUDA attestation values age and should no longer be used.  Every table in the TUDA MIB has a primary index with the value of a separate scalar cycle counter object that disambiguates the transition from one attestation cycle to the next.</li>
  <li>Over time, the measurement log information (for example) may grow large. Therefore, read-only cycle counter scalar objects in all TUDA MIB object groups facilitate more efficient access with SNMP GetNext requests.</li>
  <li>Notifications are supported by an SNMP trap definition with all of the cycle counters as bindings, to alert a Verifier that a new attestation cycle has occurred (e.g., synchronization data, measurement log, etc. have been updated by adding new rows and possibly deleting old rows).</li>
</ol>
<h1 id="rfc.appendix.B.1"><a href="#rfc.appendix.B.1">B.1.</a> <a href="#structure-of-tuda-mib" id="structure-of-tuda-mib">Structure of TUDA MIB</a></h1>
<p id="rfc.section.B.1.p.1">The following table summarizes the object groups, tables and their indexes, and conformance requirements for the TUDA MIB:</p>
<pre>
|-------------|-------|----------|----------|----------|
| Group/Table | Cycle | Instance | Fragment | Required |
|-------------|-------|----------|----------|----------|
| General     |       |          |          | x        |
| AIKCert     | x     | x        | x        |          |
| TSACert     | x     | x        | x        |          |
| SyncToken   | x     |          | x        | x        |
| Restrict    | x     |          |          | x        |
| Measure     | x     | x        |          |          |
| VerifyToken | x     |          |          | x        |
| SWIDTag     | x     | x        | x        |          |
|-------------|-------|----------|----------|----------|
</pre>
<h1 id="rfc.appendix.B.1.1"><a href="#rfc.appendix.B.1.1">B.1.1.</a> <a href="#cycle-index" id="cycle-index">Cycle Index</a></h1>
<p id="rfc.section.B.1.1.p.1">A tudaV1&lt;Group&gt;CycleIndex is the:</p>
<p/>

<ol>
  <li>first index of a row (element instance or element fragment) in the tudaV1&lt;Group&gt;Table;</li>
  <li>identifier of an update cycle on the table, when rows were added and/or deleted from the table (bounded by tudaV1&lt;Group&gt;Cycles); and</li>
  <li>binding in the tudaV1TrapV2Cycles notification for directed polling.</li>
</ol>
<h1 id="rfc.appendix.B.1.2"><a href="#rfc.appendix.B.1.2">B.1.2.</a> <a href="#instance-index" id="instance-index">Instance Index</a></h1>
<p id="rfc.section.B.1.2.p.1">A tudaV1&lt;Group&gt;InstanceIndex is the:</p>
<p/>

<ol>
  <li>second index of a row (element instance or element fragment) in the tudaV1&lt;Group&gt;Table; except for</li>
  <li>a row in the tudaV1SyncTokenTable (that has only one instance per cycle).</li>
</ol>
<h1 id="rfc.appendix.B.1.3"><a href="#rfc.appendix.B.1.3">B.1.3.</a> <a href="#fragment-index" id="fragment-index">Fragment Index</a></h1>
<p id="rfc.section.B.1.3.p.1">A tudaV1&lt;Group&gt;FragmentIndex is the:</p>
<p/>

<ol>
  <li>last index of a row (always an element fragment) in the tudaV1&lt;Group&gt;Table; and</li>
  <li>accomodation for SNMP transport mapping restrictions for large string elements that require fragmentation.</li>
</ol>
<h1 id="rfc.appendix.B.2"><a href="#rfc.appendix.B.2">B.2.</a> <a href="#relationship-to-host-resources-mib" id="relationship-to-host-resources-mib">Relationship to Host Resources MIB</a></h1>
<p id="rfc.section.B.2.p.1">The General group in the TUDA MIB is analogous to the System group in the Host Resources MIB <a href="#RFC2790">[RFC2790]</a> and provides context information for the TUDA attestation process.</p>
<p id="rfc.section.B.2.p.2">The Verify Token group in the TUDA MIB is analogous to the Device group in the Host MIB and represents the verifiable state of a TPM device and its associated system.</p>
<p id="rfc.section.B.2.p.3">The SWID Tag group (containing a Concise SWID reference hash profile <a href="#I-D-birkholz-sacm-coswid">[I-D-birkholz-sacm-coswid]</a>) in the TUDA MIB is analogous to the Software Installed and Software Running groups in the Host Resources MIB <a href="#RFC2790">[RFC2790]</a>.</p>
<h1 id="rfc.appendix.B.3"><a href="#rfc.appendix.B.3">B.3.</a> <a href="#relationship-to-entity-mib" id="relationship-to-entity-mib">Relationship to Entity MIB</a></h1>
<p id="rfc.section.B.3.p.1">The General group in the TUDA MIB is analogous to the Entity General group in the Entity MIB v4 <a href="#RFC6933">[RFC6933]</a> and provides context information for the TUDA attestation process.</p>
<p id="rfc.section.B.3.p.2">The SWID Tag group in the TUDA MIB is analogous to the Entity Logical group in the Entity MIB v4 <a href="#RFC6933">[RFC6933]</a>.</p>
<h1 id="rfc.appendix.B.4"><a href="#rfc.appendix.B.4">B.4.</a> <a href="#relationship-to-other-mibs" id="relationship-to-other-mibs">Relationship to Other MIBs</a></h1>
<p id="rfc.section.B.4.p.1">The General group in the TUDA MIB is analogous to the System group in MIB-II <a href="#RFC1213">[RFC1213]</a> and the System group in the SNMPv2 MIB <a href="#RFC3418">[RFC3418]</a> and provides context information for the TUDA attestation process.</p>
<h1 id="rfc.appendix.B.5"><a href="#rfc.appendix.B.5">B.5.</a> <a href="#definition-of-tuda-mib" id="definition-of-tuda-mib">Definition of TUDA MIB</a></h1>
<pre>
&lt;CODE BEGINS&gt;
TUDA-V1-ATTESTATION-MIB DEFINITIONS ::= BEGIN

IMPORTS
    MODULE-IDENTITY, OBJECT-TYPE, Integer32, Counter32,
    enterprises, NOTIFICATION-TYPE
        FROM SNMPv2-SMI                 -- RFC 2578
    MODULE-COMPLIANCE, OBJECT-GROUP, NOTIFICATION-GROUP
        FROM SNMPv2-CONF                -- RFC 2580
    SnmpAdminString
        FROM SNMP-FRAMEWORK-MIB;        -- RFC 3411

tudaV1MIB MODULE-IDENTITY
    LAST-UPDATED    "201701090000Z" -- 09 Januar 2017
    ORGANIZATION
        "Fraunhofer SIT"
    CONTACT-INFO
        "Andreas Fuchs
        Fraunhofer Institute for Secure Information Technology
        Email: andreas.fuchs@sit.fraunhofer.de

        Henk Birkholz
        Fraunhofer Institute for Secure Information Technology
        Email: henk.birkholz@sit.fraunhofer.de

        Ira E McDonald
        High North Inc
        Email: blueroofmusic@gmail.com

        Carsten Bormann
        Universitaet Bremen TZI
        Email: cabo@tzi.org"

    DESCRIPTION
        "The MIB module for monitoring of time-based unidirectional
        attestation information from a network endpoint system,
        based on the Trusted Computing Group TPM 1.2 definition.

        Copyright (C) High North Inc (2017)."

    REVISION "201701090000Z" -- 09 January 2017
        DESCRIPTION
        "Fourth version, published as draft-birkholz-tuda-03."
    
    REVISION "201607080000Z" -- 08 July 2016
    DESCRIPTION
        "Third version, published as draft-birkholz-tuda-02."

    REVISION "201603210000Z" -- 21 March 2016
    DESCRIPTION
        "Second version, published as draft-birkholz-tuda-01."

    REVISION "201510180000Z" -- 18 October 2015
    DESCRIPTION
        "Initial version, published as draft-birkholz-tuda-00."

        ::= { enterprises fraunhofersit(21616) mibs(1) tudaV1MIB(1) }

tudaV1MIBNotifications      OBJECT IDENTIFIER ::= { tudaV1MIB 0 }
tudaV1MIBObjects            OBJECT IDENTIFIER ::= { tudaV1MIB 1 }
tudaV1MIBConformance        OBJECT IDENTIFIER ::= { tudaV1MIB 2 }

--
--  General
--
tudaV1General           OBJECT IDENTIFIER ::= { tudaV1MIBObjects 1 }

tudaV1GeneralCycles OBJECT-TYPE
    SYNTAX      Counter32
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "Count of TUDA update cycles that have occurred, i.e.,
        sum of all the individual group cycle counters.

        DEFVAL intentionally omitted - counter object."
    ::= { tudaV1General 1 }

tudaV1GeneralVersionInfo OBJECT-TYPE
    SYNTAX      SnmpAdminString (SIZE(0..255))
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "Version information for TUDA MIB, e.g., specific release
        version of TPM 1.2 base specification and release version
        of TPM 1.2 errata specification and manufacturer and model
        TPM module itself."
    DEFVAL      { "" }
    ::= { tudaV1General 2 }

--
--  AIK Cert
--
tudaV1AIKCert           OBJECT IDENTIFIER ::= { tudaV1MIBObjects 2 }

tudaV1AIKCertCycles OBJECT-TYPE
    SYNTAX      Counter32
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "Count of AIK Certificate chain update cycles that have 
        occurred.

        DEFVAL intentionally omitted - counter object."
    ::= { tudaV1AIKCert 1 }

tudaV1AIKCertTable OBJECT-TYPE
    SYNTAX      SEQUENCE OF TudaV1AIKCertEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "A table of fragments of AIK Certificate data."
    ::= { tudaV1AIKCert 2 }

tudaV1AIKCertEntry OBJECT-TYPE
    SYNTAX      TudaV1AIKCertEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "An entry for one fragment of AIK Certificate data."
    INDEX       { tudaV1AIKCertCycleIndex,
                  tudaV1AIKCertInstanceIndex,
                  tudaV1AIKCertFragmentIndex }
    ::= { tudaV1AIKCertTable 1 }

TudaV1AIKCertEntry ::=
    SEQUENCE {
        tudaV1AIKCertCycleIndex         Integer32,
        tudaV1AIKCertInstanceIndex      Integer32,
        tudaV1AIKCertFragmentIndex      Integer32,
        tudaV1AIKCertData               OCTET STRING
    }

tudaV1AIKCertCycleIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "High-order index of this AIK Certificate fragment.
        Index of an AIK Certificate chain update cycle that has
        occurred (bounded by the value of tudaV1AIKCertCycles).

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1AIKCertEntry 1 }

tudaV1AIKCertInstanceIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "Middle index of this AIK Certificate fragment.
        Ordinal of this AIK Certificate in this chain, where the AIK
        Certificate itself has an ordinal of '1' and higher ordinals
        go *up* the certificate chain to the Root CA.

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1AIKCertEntry 2 }

tudaV1AIKCertFragmentIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "Low-order index of this AIK Certificate fragment.

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1AIKCertEntry 3 }

tudaV1AIKCertData OBJECT-TYPE
    SYNTAX      OCTET STRING (SIZE(0..1024))
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "A fragment of CBOR encoded AIK Certificate data."
    DEFVAL      { "" }
    ::= { tudaV1AIKCertEntry 4 }

--
--  TSA Cert
--
tudaV1TSACert           OBJECT IDENTIFIER ::= { tudaV1MIBObjects 3 }

tudaV1TSACertCycles OBJECT-TYPE
    SYNTAX      Counter32
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "Count of TSA Certificate chain update cycles that have 
        occurred.

        DEFVAL intentionally omitted - counter object."
    ::= { tudaV1TSACert 1 }

tudaV1TSACertTable OBJECT-TYPE
    SYNTAX      SEQUENCE OF TudaV1TSACertEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "A table of fragments of TSA Certificate data."
    ::= { tudaV1TSACert 2 }

tudaV1TSACertEntry OBJECT-TYPE
    SYNTAX      TudaV1TSACertEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "An entry for one fragment of TSA Certificate data."
    INDEX       { tudaV1TSACertCycleIndex,
                  tudaV1TSACertInstanceIndex,
                  tudaV1TSACertFragmentIndex }
    ::= { tudaV1TSACertTable 1 }

TudaV1TSACertEntry ::=
    SEQUENCE {
        tudaV1TSACertCycleIndex         Integer32,
        tudaV1TSACertInstanceIndex      Integer32,
        tudaV1TSACertFragmentIndex      Integer32,
        tudaV1TSACertData               OCTET STRING
    }

tudaV1TSACertCycleIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "High-order index of this TSA Certificate fragment.
        Index of a TSA Certificate chain update cycle that has
        occurred (bounded by the value of tudaV1TSACertCycles).

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1TSACertEntry 1 }

tudaV1TSACertInstanceIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "Middle index of this TSA Certificate fragment.
        Ordinal of this TSA Certificate in this chain, where the TSA
        Certificate itself has an ordinal of '1' and higher ordinals
        go *up* the certificate chain to the Root CA.

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1TSACertEntry 2 }

tudaV1TSACertFragmentIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "Low-order index of this TSA Certificate fragment.

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1TSACertEntry 3 }

tudaV1TSACertData OBJECT-TYPE
    SYNTAX      OCTET STRING (SIZE(0..1024))
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "A fragment of CBOR encoded TSA Certificate data."
    DEFVAL      { "" }
    ::= { tudaV1TSACertEntry 4 }

--
--  Sync Token
--
tudaV1SyncToken         OBJECT IDENTIFIER ::= { tudaV1MIBObjects 4 }

tudaV1SyncTokenCycles OBJECT-TYPE
    SYNTAX      Counter32
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "Count of Sync Token update cycles that have 
        occurred.

        DEFVAL intentionally omitted - counter object."
    ::= { tudaV1SyncToken 1 }
        
tudaV1SyncTokenInstances OBJECT-TYPE
    SYNTAX      Counter32
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "Count of Sync Token instance entries that have
        been recorded (some entries MAY have been pruned).

        DEFVAL intentionally omitted - counter object."
    ::= { tudaV1SyncToken 2 }

tudaV1SyncTokenTable OBJECT-TYPE
    SYNTAX      SEQUENCE OF TudaV1SyncTokenEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "A table of fragments of Sync Token data."
    ::= { tudaV1SyncToken 3 }

tudaV1SyncTokenEntry OBJECT-TYPE
    SYNTAX      TudaV1SyncTokenEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "An entry for one fragment of Sync Token data."
    INDEX       { tudaV1SyncTokenCycleIndex,
                                  tudaV1SyncTokenInstanceIndex,
                  tudaV1SyncTokenFragmentIndex }
    ::= { tudaV1SyncTokenTable 1 }

TudaV1SyncTokenEntry ::=
    SEQUENCE {
        tudaV1SyncTokenCycleIndex       Integer32,
                tudaV1SyncTokenInstanceIndex    Integer32,
        tudaV1SyncTokenFragmentIndex    Integer32,
        tudaV1SyncTokenData             OCTET STRING
    }

tudaV1SyncTokenCycleIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "High-order index of this Sync Token fragment.
        Index of a Sync Token update cycle that has
        occurred (bounded by the value of tudaV1SyncTokenCycles).

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1SyncTokenEntry 1 }
        
tudaV1SyncTokenInstanceIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "Middle index of this Sync Token fragment.
        Ordinal of this instance of Sync Token data
                (NOT bounded by the value of tudaV1SyncTokenInstances).

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1SyncTokenEntry 2 }

tudaV1SyncTokenFragmentIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "Low-order index of this Sync Token fragment.

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1SyncTokenEntry 3 }

tudaV1SyncTokenData OBJECT-TYPE
    SYNTAX      OCTET STRING (SIZE(0..1024))
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "A fragment of CBOR encoded Sync Token data."
    DEFVAL      { "" }
    ::= { tudaV1SyncTokenEntry 4 }

--
--  Restriction Info
--
tudaV1Restrict          OBJECT IDENTIFIER ::= { tudaV1MIBObjects 5 }

tudaV1RestrictCycles OBJECT-TYPE
    SYNTAX      Counter32
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "Count of Restriction Info update cycles that have 
        occurred.

        DEFVAL intentionally omitted - counter object."
    ::= { tudaV1Restrict 1 }

tudaV1RestrictTable OBJECT-TYPE
    SYNTAX      SEQUENCE OF TudaV1RestrictEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "A table of instances of Restriction Info data."
    ::= { tudaV1Restrict 2 }

tudaV1RestrictEntry OBJECT-TYPE
    SYNTAX      TudaV1RestrictEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "An entry for one instance of Restriction Info data."
    INDEX       { tudaV1RestrictCycleIndex }
    ::= { tudaV1RestrictTable 1 }

TudaV1RestrictEntry ::=
    SEQUENCE {
        tudaV1RestrictCycleIndex        Integer32,
        tudaV1RestrictData              OCTET STRING
    }

tudaV1RestrictCycleIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "Index of this Restriction Info entry.
        Index of a Restriction Info update cycle that has
        occurred (bounded by the value of tudaV1RestrictCycles).

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1RestrictEntry 1 }


tudaV1RestrictData OBJECT-TYPE
    SYNTAX      OCTET STRING (SIZE(0..1024))
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "An instance of CBOR encoded Restriction Info data."
    DEFVAL      { "" }
    ::= { tudaV1RestrictEntry 2 }

--
--  Measurement Log
--
tudaV1Measure           OBJECT IDENTIFIER ::= { tudaV1MIBObjects 6 }

tudaV1MeasureCycles OBJECT-TYPE
    SYNTAX      Counter32
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "Count of Measurement Log update cycles that have 
        occurred.

        DEFVAL intentionally omitted - counter object."
    ::= { tudaV1Measure 1 }

tudaV1MeasureInstances OBJECT-TYPE
    SYNTAX      Counter32
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "Count of Measurement Log instance entries that have
        been recorded (some entries MAY have been pruned).

        DEFVAL intentionally omitted - counter object."
    ::= { tudaV1Measure 2 }

tudaV1MeasureTable OBJECT-TYPE
    SYNTAX      SEQUENCE OF TudaV1MeasureEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "A table of instances of Measurement Log data."
    ::= { tudaV1Measure 3 }

tudaV1MeasureEntry OBJECT-TYPE
    SYNTAX      TudaV1MeasureEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "An entry for one instance of Measurement Log data."
    INDEX       { tudaV1MeasureCycleIndex,
                  tudaV1MeasureInstanceIndex }
    ::= { tudaV1MeasureTable 1 }

TudaV1MeasureEntry ::=
    SEQUENCE {
        tudaV1MeasureCycleIndex         Integer32,
        tudaV1MeasureInstanceIndex      Integer32,
        tudaV1MeasureData               OCTET STRING
    }

tudaV1MeasureCycleIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "High-order index of this Measurement Log entry.
        Index of a Measurement Log update cycle that has
        occurred (bounded by the value of tudaV1MeasureCycles).

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1MeasureEntry 1 }

tudaV1MeasureInstanceIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "Low-order index of this Measurement Log entry.
        Ordinal of this instance of Measurement Log data
        (NOT bounded by the value of tudaV1MeasureInstances).

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1MeasureEntry 2 }

tudaV1MeasureData OBJECT-TYPE
    SYNTAX      OCTET STRING (SIZE(0..1024))
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "A instance of CBOR encoded Measurement Log data."
    DEFVAL      { "" }
    ::= { tudaV1MeasureEntry 3 }

--
--  Verify Token
--
tudaV1VerifyToken       OBJECT IDENTIFIER ::= { tudaV1MIBObjects 7 }

tudaV1VerifyTokenCycles OBJECT-TYPE
    SYNTAX      Counter32
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "Count of Verify Token update cycles that have 
        occurred.

        DEFVAL intentionally omitted - counter object."
    ::= { tudaV1VerifyToken 1 }

tudaV1VerifyTokenTable OBJECT-TYPE
    SYNTAX      SEQUENCE OF TudaV1VerifyTokenEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "A table of instances of Verify Token data."
    ::= { tudaV1VerifyToken 2 }

tudaV1VerifyTokenEntry OBJECT-TYPE
    SYNTAX      TudaV1VerifyTokenEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "An entry for one instance of Verify Token data."
    INDEX       { tudaV1VerifyTokenCycleIndex }
    ::= { tudaV1VerifyTokenTable 1 }

TudaV1VerifyTokenEntry ::=
    SEQUENCE {
        tudaV1VerifyTokenCycleIndex     Integer32,
        tudaV1VerifyTokenData           OCTET STRING
    }

tudaV1VerifyTokenCycleIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "Index of this instance of Verify Token data.
        Index of a Verify Token update cycle that has
        occurred (bounded by the value of tudaV1VerifyTokenCycles).

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1VerifyTokenEntry 1 }

tudaV1VerifyTokenData OBJECT-TYPE
    SYNTAX      OCTET STRING (SIZE(0..1024))
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "A instance of CBOR encoded Verify Token data."
    DEFVAL      { "" }
    ::= { tudaV1VerifyTokenEntry 2 }

--
--  SWID Tag
--
tudaV1SWIDTag           OBJECT IDENTIFIER ::= { tudaV1MIBObjects 8 }

tudaV1SWIDTagCycles OBJECT-TYPE
    SYNTAX      Counter32
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "Count of SWID Tag update cycles that have occurred.

        DEFVAL intentionally omitted - counter object."
    ::= { tudaV1SWIDTag 1 }

tudaV1SWIDTagTable OBJECT-TYPE
    SYNTAX      SEQUENCE OF TudaV1SWIDTagEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "A table of fragments of SWID Tag data."
    ::= { tudaV1SWIDTag 2 }

tudaV1SWIDTagEntry OBJECT-TYPE
    SYNTAX      TudaV1SWIDTagEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "An entry for one fragment of SWID Tag data."
    INDEX       { tudaV1SWIDTagCycleIndex,
                  tudaV1SWIDTagInstanceIndex,
                  tudaV1SWIDTagFragmentIndex }
    ::= { tudaV1SWIDTagTable 1 }

TudaV1SWIDTagEntry ::=
    SEQUENCE {
        tudaV1SWIDTagCycleIndex         Integer32,
        tudaV1SWIDTagInstanceIndex      Integer32,
        tudaV1SWIDTagFragmentIndex      Integer32,
        tudaV1SWIDTagData               OCTET STRING
    }

tudaV1SWIDTagCycleIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "High-order index of this SWID Tag fragment.
        Index of an SWID Tag update cycle that has
        occurred (bounded by the value of tudaV1SWIDTagCycles).

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1SWIDTagEntry 1 }

tudaV1SWIDTagInstanceIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "Middle index of this SWID Tag fragment.
        Ordinal of this SWID Tag instance in this update cycle.

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1SWIDTagEntry 2 }

tudaV1SWIDTagFragmentIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "Low-order index of this SWID Tag fragment.

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1SWIDTagEntry 3 }

tudaV1SWIDTagData OBJECT-TYPE
    SYNTAX      OCTET STRING (SIZE(0..1024))
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "A fragment of CBOR encoded SWID Tag data."
    DEFVAL      { "" }
    ::= { tudaV1SWIDTagEntry 4 }

--
--  Trap Cycles
--
tudaV1TrapV2Cycles NOTIFICATION-TYPE
    OBJECTS {
        tudaV1GeneralCycles,
        tudaV1AIKCertCycles,
        tudaV1TSACertCycles,
        tudaV1SyncTokenCycles,
        tudaV1SyncTokenInstances,
        tudaV1RestrictCycles,
        tudaV1MeasureCycles,
        tudaV1MeasureInstances,
        tudaV1VerifyTokenCycles,
        tudaV1SWIDTagCycles
    }
    STATUS  current
    DESCRIPTION
        "This trap is sent when the value of any cycle or instance
        counter changes (i.e., one or more tables are updated).

        Note:  The value of sysUpTime in IETF MIB-II (RFC 1213) is
        always included in SNMPv2 traps, per RFC 3416."
    ::= { tudaV1MIBNotifications 1 }

--
--  Conformance Information
--
tudaV1Compliances           OBJECT IDENTIFIER
    ::= { tudaV1MIBConformance 1 }

tudaV1ObjectGroups          OBJECT IDENTIFIER
    ::= { tudaV1MIBConformance 2 }

tudaV1NotificationGroups    OBJECT IDENTIFIER
    ::= { tudaV1MIBConformance 3 }

--
--  Compliance Statements
--
tudaV1BasicCompliance MODULE-COMPLIANCE
    STATUS  current
    DESCRIPTION
        "An implementation that complies with this module MUST
        implement all of the objects defined in the mandatory
        group tudaV1BasicGroup."
    MODULE  -- this module
    MANDATORY-GROUPS { tudaV1BasicGroup }

    GROUP   tudaV1OptionalGroup
    DESCRIPTION
        "The optional TUDA MIB objects.
        An implementation MAY implement this group."

    GROUP   tudaV1TrapGroup
    DESCRIPTION
        "The TUDA MIB traps.
        An implementation SHOULD implement this group."
    ::= { tudaV1Compliances 1 }

--
--  Compliance Groups
--
tudaV1BasicGroup OBJECT-GROUP
    OBJECTS {
        tudaV1GeneralCycles,
        tudaV1GeneralVersionInfo,
        tudaV1SyncTokenCycles,
        tudaV1SyncTokenInstances,
        tudaV1SyncTokenData,
        tudaV1RestrictCycles,
        tudaV1RestrictData,
        tudaV1VerifyTokenCycles,
        tudaV1VerifyTokenData
    }
    STATUS  current
    DESCRIPTION
        "The basic mandatory TUDA MIB objects."
    ::= { tudaV1ObjectGroups 1 }

tudaV1OptionalGroup OBJECT-GROUP
    OBJECTS {
        tudaV1AIKCertCycles,
        tudaV1AIKCertData,
        tudaV1TSACertCycles,
        tudaV1TSACertData,
        tudaV1MeasureCycles,
        tudaV1MeasureInstances,
        tudaV1MeasureData,
        tudaV1SWIDTagCycles,
        tudaV1SWIDTagData
    }
    STATUS  current
    DESCRIPTION
        "The optional TUDA MIB objects."
    ::= { tudaV1ObjectGroups 2 }

tudaV1TrapGroup NOTIFICATION-GROUP
    NOTIFICATIONS { tudaV1TrapV2Cycles }
    STATUS      current
    DESCRIPTION
        "The recommended TUDA MIB traps - notifications."
    ::= { tudaV1NotificationGroups 1 }

END
&lt;CODE ENDS&gt;
</pre>
<h1 id="rfc.appendix.C"><a href="#rfc.appendix.C">Appendix C.</a> <a href="#yang" id="yang">YANG Realization</a></h1>
<pre>
TBD

</pre>
<h1 id="rfc.appendix.D"><a href="#rfc.appendix.D">Appendix D.</a> <a href="#tpm12" id="tpm12">Realization with TPM 1.2 functions</a></h1>
<h1 id="rfc.appendix.D.1"><a href="#rfc.appendix.D.1">D.1.</a> <a href="#tpm-functions" id="tpm-functions">TPM Functions</a></h1>
<p id="rfc.section.D.1.p.1">The following TPM structures, resources and functions are used within this approach.  They are based upon the TPM 1.2 specification <a href="#TPM12">[TPM12]</a>.</p>
<h1 id="rfc.appendix.D.1.1"><a href="#rfc.appendix.D.1.1">D.1.1.</a> <a href="#tick-session-and-tick-stamp" id="tick-session-and-tick-stamp">Tick-Session and Tick-Stamp</a></h1>
<p id="rfc.section.D.1.1.p.1">On every boot, the TPM initializes a new Tick-Session. Such a tick-session consists of a nonce that is randomly created upon each boot to identify the current boot-cycle &#8211; the phase between boot-time of the device and shutdown or power-off &#8211; and prevent replaying of old tick-session values. The TPM uses its internal entropy source that guarantees virtually no collisions of the nonce values between two of such boot cycles.</p>
<p id="rfc.section.D.1.1.p.2">It further includes an internal timer that is being initialize to Zero on each reboot. From this point on, the TPM increments this timer continuously based upon its internal secure clocking information until the device is powered down or set to sleep.  By its hardware design, the TPM will detect attacks on any of those properties.</p>
<p id="rfc.section.D.1.1.p.3">The TPM offers the function TPM_TickStampBlob, which allows the TPM to create a signature over the current tick-session and two externally provided input values. These input values are designed to serve as a nonce and as payload data to be included in a TickStampBlob: TickstampBlob := sig(TPM-key, currentTicks || nonce || externalData).</p>
<p id="rfc.section.D.1.1.p.4">As a result, one is able to proof that at a certain point in time (relative to the tick-session) after the provisioning of a certain nonce, some certain externalData was known and provided to the TPM. If an approach however requires no input values or only one input value (such as the use in this document) the input values can be set to well-known value. The convention used within TCG specifications and within this document is to use twenty bytes of zero h'0000000000000000000000000000000000000000' as well-known value.</p>
<h1 id="rfc.appendix.D.1.2"><a href="#rfc.appendix.D.1.2">D.1.2.</a> <a href="#platform-configuration-registers-pcrs" id="platform-configuration-registers-pcrs">Platform Configuration Registers (PCRs)</a></h1>
<p id="rfc.section.D.1.2.p.1">The TPM is a secure cryptoprocessor that provides the ability to store measurements and metrics about an endpoint's configuration and state in a secure, tamper-proof environment. Each of these security relevant metrics can be stored in a volatile Platform Configuration Register (PCR) inside the TPM. These measurements can be conducted at any point in time, ranging from an initial BIOS boot-up sequence to measurements taken after hundreds of hours of uptime.</p>
<p id="rfc.section.D.1.2.p.2">The initial measurement is triggered by the Platforms so-called pre-BIOS or ROM-code.  It will conduct a measurement of the first loadable pieces of code; i.e.\ the BIOS.  The BIOS will in turn measure its Option ROMs and the BootLoader, which measures the OS-Kernel, which in turn measures its applications. This describes a so-called measurement chain. This typically gets recorded in a so-called measurement log, such that the values of the PCRs can be reconstructed from the individual measurements for validation.</p>
<p id="rfc.section.D.1.2.p.3">Via its PCRs, a TPM provides a Root of Trust that can, for example, support secure boot or remote attestation. The attestation of an endpoint's identity or security posture is based on the content of an TPM's PCRs (platform integrity measurements).</p>
<h1 id="rfc.appendix.D.1.3"><a href="#rfc.appendix.D.1.3">D.1.3.</a> <a href="#pcr-restricted-keys" id="pcr-restricted-keys">PCR restricted Keys</a></h1>
<p id="rfc.section.D.1.3.p.1">Every key inside the TPM can be restricted in such a way that it can only be used if a certain set of PCRs are in a predetermined state. For key creation the desired state for PCRs are defined via the PCRInfo field inside the keyInfo parameter.  Whenever an operation using this key is performed, the TPM first checks whether the PCRs are in the correct state. Otherwise the operation is denied by the TPM.</p>
<h1 id="rfc.appendix.D.1.4"><a href="#rfc.appendix.D.1.4">D.1.4.</a> <a href="#certifyinfo" id="certifyinfo">CertifyInfo</a></h1>
<p id="rfc.section.D.1.4.p.1">The TPM offers a command to certify the properties of a key by means of a signature using another key. This includes especially the keyInfo which in turn includes the PCRInfo information used during key creation. This way, a third party can be assured about the fact that a key is only usable if the PCRs are in a certain state.</p>
<h1 id="rfc.appendix.D.2"><a href="#rfc.appendix.D.2">D.2.</a> <a href="#protocol-and-procedure" id="protocol-and-procedure">Protocol and Procedure</a></h1>
<h1 id="rfc.appendix.D.2.1"><a href="#rfc.appendix.D.2.1">D.2.1.</a> <a href="#aik" id="aik">AIK and AIK Certificate</a></h1>
<p id="rfc.section.D.2.1.p.1">Attestations are based upon a cryptographic signature performed by the TPM using a so-called Attestation Identity Key (AIK). An AIK has the properties that it cannot be exported from a TPM and is used for attestations. Trust in the AIK is established by an X.509 Certificate emitted by a Certificate Authority. The AIK certificate is either provided directly or via a so-called PrivacyCA <a href="#AIK-Enrollment">[AIK-Enrollment]</a>.</p>
<p id="rfc.section.D.2.1.p.2">This element consists of the AIK certificate that includes the AIK's public key used during verification as well as the certificate chain up to the Root CA for validation of the AIK certificate itself.</p>
<div id="rfc.figure.2"/>
<div id="cert-token"/>
<pre>
TUDA-Cert = [AIK-Cert, TSA-Cert]; maybe split into two for SNMP
AIK-Cert = Cert
TSA-Cert = Cert
</pre>
<p class="figure">Figure 2: TUDA-Cert element in CDDL</p>
<p id="rfc.section.D.2.1.p.3">The TSA-Cert is a standard certificate of the TSA.</p>
<p id="rfc.section.D.2.1.p.4">The AIK-Cert may be provisioned in a secure environment using standard means or it may follow the PrivacyCA protocols. <a href="#make-cert-token">Figure 3</a> gives a rough sketch of this protocol. See <a href="#AIK-Enrollment">[AIK-Enrollment]</a> for more information.</p>
<p id="rfc.section.D.2.1.p.5">The X.509 Certificate is built from the AIK public key and the corresponding PKCS #7 certificate chain, as shown in <a href="#make-cert-token">Figure 3</a>.</p>
<p id="rfc.section.D.2.1.p.6">Required TPM functions:</p>
<div id="rfc.figure.3"/>
<div id="make-cert-token"/>
<pre>
| create_AIK_Cert(...) = {
|   AIK = TPM_MakeIdentity()
|   IdReq = CollateIdentityRequest(AIK,EK)
|   IdRes = Call(AIK-CA, IdReq)
|   AIK-Cert = TPM_ActivateIdentity(AIK, IdRes)
| }
|
| /* Alternative */
|
| create_AIK_Cert(...) = {
|   AIK = TPM_CreateWrapKey(Identity)
|   AIK-Cert = Call(AIK-CA, AIK.pubkey)
| }
</pre>
<p class="figure">Figure 3: Creating the TUDA-Cert element</p>
<h1 id="rfc.appendix.D.2.2"><a href="#rfc.appendix.D.2.2">D.2.2.</a> <a href="#synchronization-token" id="synchronization-token">Synchronization Token</a></h1>
<p id="rfc.section.D.2.2.p.1">The reference for Attestations are the Tick-Sessions of the TPM. In order to put Attestations into relation with a Real Time Clock (RTC), it is necessary to provide a cryptographic synchronization between the tick session and the RTC. To do so, a synchronization protocol is run with a Time Stamp Authority (TSA) that consists of three steps:</p>
<p/>

<ul>
  <li>The TPM creates a TickStampBlob using the AIK</li>
  <li>This TickstampBlob is used as nonce to the Timestamp of the TSA</li>
  <li>Another TickStampBlob with the AIK is created using the TSA's Timestamp a nonce</li>
</ul>
<p id="rfc.section.D.2.2.p.3">The first TickStampBlob is called "left" and the second "right" in a reference to their position on a time-axis.</p>
<p id="rfc.section.D.2.2.p.4">These three elements, with the TSA's certificate factored out, form the synchronization token</p>
<div id="rfc.figure.4"/>
<div id="sync-token"/>
<pre>
TUDA-Synctoken = [
  left: TickStampBlob-Output,
  timestamp: TimeStampToken,
  right: TickStampBlob-Output,
]

TimeStampToken = bytes ; RFC 3161

TickStampBlob-Output = [
  currentTicks: TPM-CURRENT-TICKS,
  sig: bytes,
]

TPM-CURRENT-TICKS = [
  currentTicks: uint
  ? (
    tickRate: uint
    tickNonce: TPM-NONCE
  )
]
; Note that TickStampBlob-Output "right" can omit the values for
;   tickRate and tickNonce since they are the same as in "left"

TPM-NONCE = bytes .size 20
</pre>
<p class="figure">Figure 4: TUDA-Sync element in CDDL</p>
<p id="rfc.section.D.2.2.p.5">Required TPM functions:</p>
<div id="rfc.figure.5"/>
<div id="make-sync-token"/>
<pre>
| dummyDigest = h'0000000000000000000000000000000000000000'
| dummyNonce = dummyDigest
|
| create_sync_token(AIKHandle, TSA) = {
|   ts_left = TPM_TickStampBlob(
|       keyHandle = AIK_Handle,      /*TPM_KEY_HANDLE*/
|       antiReplay = dummyNonce,     /*TPM_NONCE*/
|       digestToStamp = dummyDigest  /*TPM_DIGEST*/)
|
|   ts = TSA_Timestamp(TSA, nonce = hash(ts_left))
|
|   ts_right = TPM_TickStampBlob(
|       keyHandle = AIK_Handle,      /*TPM_KEY_HANDLE*/
|       antiReplay = dummyNonce,     /*TPM_NONCE*/
|       digestToStamp = hash(ts))    /*TPM_DIGEST*/
|
|   TUDA-SyncToken = [[ts_left.ticks, ts_left.sig], ts,
|                     [ts_right.ticks.currentTicks, ts_right.sig]]
|   /* Note: skip the nonce and tickRate field for ts_right.ticks */
| }

</pre>
<p class="figure">Figure 5: Creating the Sync-Token element</p>
<h1 id="rfc.appendix.D.2.3"><a href="#rfc.appendix.D.2.3">D.2.3.</a> <a href="#restrictioninfo" id="restrictioninfo">RestrictionInfo</a></h1>
<p id="rfc.section.D.2.3.p.1">The attestation relies on the capability of the TPM to operate on restricted keys.  Whenever the PCR values for the machine to be attested change, a new restricted key is created that can only be operated as long as the PCRs remain in their current state.</p>
<p id="rfc.section.D.2.3.p.2">In order to prove to the Verifier that this restricted temporary key actually has these properties and also to provide the PCR value that it is restricted, the TPM command TPM_CertifyInfo is used. It creates a signed certificate using the AIK about the newly created restricted key.</p>
<p id="rfc.section.D.2.3.p.3">This token is formed from the list of:</p>
<p/>

<ul>
  <li>PCR list,</li>
  <li>the newly created restricted public key, and</li>
  <li>the certificate.</li>
</ul>
<div id="rfc.figure.6"/>
<div id="key-token"/>
<pre>
TUDA-RestrictionInfo = [Composite,
                        restrictedKey_Pub: Pubkey,
                        CertifyInfo]

PCRSelection = bytes .size (2..4) ; used as bit string

Composite = [
  bitmask: PCRSelection,
  values: [*PCR-Hash],
]

Pubkey = bytes ; may be extended to COSE pubkeys

CertifyInfo = [
  TPM-CERTIFY-INFO,
  sig: bytes,
]

TPM-CERTIFY-INFO = [
  ; we don't encode TPM-STRUCT-VER:
  ; these are 4 bytes always equal to h'01010000'
  keyUsage: uint, ; 4byte? 2byte?
  keyFlags: bytes .size 4, ; 4byte
  authDataUsage: uint, ; 1byte (enum)
  algorithmParms: TPM-KEY-PARMS,
  pubkeyDigest: Hash,
  ; we don't encode TPM-NONCE data, which is 20 bytes, all zero
  parentPCRStatus: bool,
  ; no need to encode pcrinfosize
  pcrinfo: TPM-PCR-INFO,        ; we have exactly one
]

TPM-PCR-INFO = [
    pcrSelection: PCRSelection; /* TPM_PCR_SELECTION */
    digestAtRelease: PCR-Hash;  /* TPM_COMPOSITE_HASH */
    digestAtCreation: PCR-Hash; /* TPM_COMPOSITE_HASH */
]

TPM-KEY-PARMS = [
  ; algorithmID: uint, ; &lt;= 4 bytes -- not encoded, constant for TPM1.2
  encScheme: uint, ; &lt;= 2 bytes
  sigScheme: uint, ; &lt;= 2 bytes
  parms: TPM-RSA-KEY-PARMS,
]

TPM-RSA-KEY-PARMS = [
  ; "size of the RSA key in bits":
  keyLength: uint
  ; "number of prime factors used by this RSA key":
  numPrimes: uint
  ; "This SHALL be the size of the exponent":
  exponentSize: null / uint / biguint
  ; "If the key is using the default exponent then the exponentSize
  ; MUST be 0" -&gt; we represent this case as null
]

</pre>
<p class="figure">Figure 6: TUDA-Key element in CDDL</p>
<p id="rfc.section.D.2.3.p.5">Required TPM functions:</p>
<div id="rfc.figure.7"/>
<div id="make-pubkey"/>
<pre>
| dummyDigest = h'0000000000000000000000000000000000000000'
| dummyNonce = dummyDigest
|
| create_Composite
|
| create_restrictedKey_Pub(pcrsel) = {
|   PCRInfo = {pcrSelection = pcrsel,
|              digestAtRelease = hash(currentValues(pcrSelection))
|              digestAtCreation = dummyDigest}
|   / * PCRInfo is a TPM_PCR_INFO and thus also a TPM_KEY */
|
|   wk = TPM_CreateWrapKey(keyInfo = PCRInfo)
|   wk.keyInfo.pubKey
| }
|
| create_TPM-Certify-Info = {
|   CertifyInfo = TPM_CertifyKey(
|       certHandle = AIK,          /* TPM_KEY_HANDLE */
|       keyHandle = wk,            /* TPM_KEY_HANDLE */
|       antiReply = dummyNonce)    /* TPM_NONCE */
|
|   CertifyInfo.strip()
|   /* Remove those values that are not needed */
| }
</pre>
<p class="figure">Figure 7: Creating the pubkey</p>
<h1 id="rfc.appendix.D.2.4"><a href="#rfc.appendix.D.2.4">D.2.4.</a> <a href="#measurement-log" id="measurement-log">Measurement Log</a></h1>
<p id="rfc.section.D.2.4.p.1">Similarly to regular attestations, the Verifier needs a way to reconstruct the PCRs' values in order to estimate the trustworthiness of the device. As such, a list of those elements that were extended into the PCRs is reported. Note though that for certain environments, this step may be optional if a list of valid PCR configurations exists and no measurement log is required.</p>
<pre>
TUDA-Measurement-Log = [*PCR-Event]
PCR-Event = [
  type: PCR-Event-Type,
  pcr: uint,
  template-hash: PCR-Hash,
  filedata-hash: tagged-hash,
  pathname: text; called filename-hint in ima (non-ng)
]

PCR-Event-Type = &amp;(
  bios: 0
  ima: 1
  ima-ng: 2
)

; might want to make use of COSE registry here
; however, that might never define a value for sha1
tagged-hash /= [sha1: 0, bytes .size 20]
tagged-hash /= [sha256: 1, bytes .size 32]
</pre>
<h1 id="rfc.appendix.D.2.5"><a href="#rfc.appendix.D.2.5">D.2.5.</a> <a href="#implicit-attestation" id="implicit-attestation">Implicit Attestation</a></h1>
<p id="rfc.section.D.2.5.p.1">The actual attestation is then based upon a TickStampBlob using the restricted temporary key that was certified in the steps above. The TPM-Tickstamp is executed and thereby provides evidence that at this point in time (with respect to the TPM internal tick-session) a certain configuration existed (namely the PCR values associated with the restricted key). Together with the synchronization token this tick-related timing can then be related to the real-time clock.</p>
<p id="rfc.section.D.2.5.p.2">This element consists only of the TPM_TickStampBlock with no nonce.</p>
<div id="rfc.figure.8"/>
<div id="verify-token"/>
<pre>
TUDA-Verifytoken = TickStampBlob-Output
</pre>
<p class="figure">Figure 8: TUDA-Verify element in CDDL</p>
<p id="rfc.section.D.2.5.p.3">Required TPM functions:</p>
<div id="rfc.figure.9"/>
<div id="make-verifytoken"/>
<pre>
| imp_att = TPM_TickStampBlob(
|     keyHandle = restrictedKey_Handle,     /*TPM_KEY_HANDLE*/
|     antiReplay = dummyNonce,              /*TPM_NONCE*/
|     digestToStamp = dummyDigest)          /*TPM_DIGEST*/
|
| VerifyToken = imp_att
</pre>
<p class="figure">Figure 9: Creating the Verify Token</p>
<h1 id="rfc.appendix.D.2.6"><a href="#rfc.appendix.D.2.6">D.2.6.</a> <a href="#attestation-verification-approach" id="attestation-verification-approach">Attestation Verification Approach</a></h1>
<p id="rfc.section.D.2.6.p.1">The seven TUDA information elements transport the essential content that is required to enable verification of the attestation statement at the Verifier. The following listings illustrate the verification algorithm to be used at the Verifier in pseudocode. The pseudocode provided covers the entire verification task.  If only a subset of TUDA elements changed (see <a href="#updatecycles">Section 3.1</a>), only the corresponding code listings need to be re-executed.</p>
<div id="rfc.figure.10"/>
<div id="verify-Certs"/>
<pre>
| TSA_pub = verifyCert(TSA-CA, Cert.TSA-Cert)
| AIK_pub = verifyCert(AIK-CA, Cert.AIK-Cert)
</pre>
<p class="figure">Figure 10: Verification of Certificates</p>
<div id="rfc.figure.11"/>
<div id="verify-sync"/>
<pre>
| ts_left = Synctoken.left
| ts_right = Synctoken.right
|
| /* Reconstruct ts_right's omitted values; Alternatively assert == */
| ts_right.currentTicks.tickRate = ts_left.currentTicks.tickRate
| ts_right.currentTicks.tickNonce = ts_left.currentTicks.tickNonce
|
| ticks_left = ts_left.currentTicks
| ticks_right = ts_right.currentTicks
|
| /* Verify Signatures */
| verifySig(AIK_pub, dummyNonce || dummyDigest || ticks_left)
| verifySig(TSA_pub, hash(ts_left) || timestamp.time)
| verifySig(AIK_pub, dummyNonce || hash(timestamp) || ticks_right)
|
| delta_left = timestamp.time -
|     ticks_left.currentTicks * ticks_left.tickRate / 1000
|
| delta_right = timestamp.time -
|     ticks_right.currentTicks * ticks_right.tickRate / 1000
</pre>
<p class="figure">Figure 11: Verification of Synchronization Token</p>
<div id="rfc.figure.12"/>
<div id="verify-restrictioninfo"/>
<pre>
| compositeHash = hash_init()
| for value in Composite.values:
|     hash_update(compositeHash, value)
| compositeHash = hash_finish(compositeHash)
|
| certInfo = reconstruct_static(TPM-CERTIFY-INFO)
|
| assert(Composite.bitmask == ExpectedPCRBitmask)
| assert(certInfo.pcrinfo.PCRSelection == Composite.bitmask)
| assert(certInfo.pcrinfo.digestAtRelease == compositeHash)
| assert(certInfo.pubkeyDigest == hash(restrictedKey_Pub))
|
| verifySig(AIK_pub, dummyNonce || certInfo)
</pre>
<p class="figure">Figure 12: Verification of Restriction Info</p>
<div id="rfc.figure.13"/>
<div id="verify-measurementlog"/>
<pre>
| for event in Measurement-Log:
|     if event.pcr not in ExpectedPCRBitmask:
|         continue
|     if event.type == BIOS:
|         assert_whitelist-bios(event.pcr, event.template-hash)
|     if event.type == ima:
|         assert(event.pcr == 10)
|         assert_whitelist(event.pathname, event.filedata-hash)
|         assert(event.template-hash == 
|                hash(event.pathname || event.filedata-hash))
|     if event.type == ima-ng:
|         assert(event.pcr == 10)
|         assert_whitelist-ng(event.pathname, event.filedata-hash)
|         assert(event.template-hash ==
|                hash(event.pathname || event.filedata-hash))
|
|     virtPCR[event.pcr] = hash_extend(virtPCR[event.pcr], 
|                                      event.template-hash)
|
| for pcr in ExpectedPCRBitmask:
|     assert(virtPCR[pcr] == Composite.values[i++]
</pre>
<p class="figure">Figure 13: Verification of Measurement Log</p>
<div id="rfc.figure.14"/>
<div id="verify-attestation"/>
<pre>
| ts = Verifytoken
|
| /* Reconstruct ts's omitted values; Alternatively assert == */
| ts.currentTicks.tickRate = ts_left.currentTicks.tickRate
| ts.currentTicks.tickNonce = ts_left.currentTicks.tickNonce
|
| verifySig(restrictedKey_pub, dummyNonce || dummyDigest || ts)
|
| ticks = ts.currentTicks
|
| time_left = delta_right + ticks.currentTicks * ticks.tickRate / 1000
| time_right = delta_left + ticks.currentTicks * ticks.tickRate / 1000
|
| [time_left, time_right]
</pre>
<p class="figure">Figure 14: Verification of Attestation Token</p>
<h1 id="rfc.acknowledgements">
  <a href="#rfc.acknowledgements">Acknowledgements</a>
</h1>
<h1 id="rfc.authors">
  <a href="#rfc.authors">Authors' Addresses</a>
</h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Andreas Fuchs</span> 
	  <span class="n hidden">
		<span class="family-name">Fuchs</span>
	  </span>
	</span>
	<span class="org vcardline">Fraunhofer Institute for Secure Information Technology</span>
	<span class="adr">
	  <span class="vcardline">Rheinstrasse 75</span>

	  <span class="vcardline">
		<span class="locality">Darmstadt</span>,  
		<span class="region"></span>
		<span class="code">64295</span>
	  </span>
	  <span class="country-name vcardline">Germany</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:andreas.fuchs@sit.fraunhofer.de">andreas.fuchs@sit.fraunhofer.de</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Henk Birkholz</span> 
	  <span class="n hidden">
		<span class="family-name">Birkholz</span>
	  </span>
	</span>
	<span class="org vcardline">Fraunhofer Institute for Secure Information Technology</span>
	<span class="adr">
	  <span class="vcardline">Rheinstrasse 75</span>

	  <span class="vcardline">
		<span class="locality">Darmstadt</span>,  
		<span class="region"></span>
		<span class="code">64295</span>
	  </span>
	  <span class="country-name vcardline">Germany</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:henk.birkholz@sit.fraunhofer.de">henk.birkholz@sit.fraunhofer.de</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Ira E McDonald</span> 
	  <span class="n hidden">
		<span class="family-name">McDonald</span>
	  </span>
	</span>
	<span class="org vcardline">High North Inc</span>
	<span class="adr">
	  <span class="vcardline">PO Box 221</span>

	  <span class="vcardline">
		<span class="locality">Grand Marais</span>,  
		<span class="region"></span>
		<span class="code">49839</span>
	  </span>
	  <span class="country-name vcardline">US</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:blueroofmusic@gmail.com">blueroofmusic@gmail.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Carsten Bormann</span> 
	  <span class="n hidden">
		<span class="family-name">Bormann</span>
	  </span>
	</span>
	<span class="org vcardline">Universitaet Bremen TZI</span>
	<span class="adr">
	  <span class="vcardline">Bibliothekstr. 1</span>

	  <span class="vcardline">
		<span class="locality">Bremen</span>,  
		<span class="region"></span>
		<span class="code">D-28359</span>
	  </span>
	  <span class="country-name vcardline">Germany</span>
	</span>
	<span class="vcardline">Phone: +49-421-218-63921</span>

<span class="vcardline">EMail: <a href="mailto:cabo@tzi.org">cabo@tzi.org</a></span>

  </address>
</div>

  <div class="github-fork-ribbon-wrapper"><div class="github-fork-ribbon"><a href="https://github.com/henkbirkholz/draft-birkholz-tuda">Fork me on GitHub</a></div></div>
</body>
</html>
